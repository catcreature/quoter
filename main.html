<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hello World with Quotes (CORS-safe)</title>
  <style>
    :root {
      --bg: #f0f8ff;
      --ink: #1f2937;
      --card: #ffffff;
      --muted: #6b7280;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(180deg, var(--bg), #e6f2ff);
      color: var(--ink);
      display: flex;
      flex-direction: column;
    }
    header {
      position: sticky;
      top: 0;
      background: #ecf0f1;
      backdrop-filter: saturate(130%) blur(4px);
      padding: 16px 24px;
      box-shadow: 0 4px 10px rgba(0,0,0,.08);
      z-index: 10;
    }
    header h1 {
      margin: 0;
      font-size: 1.75rem;
      display: inline-block;
      padding: 8px 16px;
      border-radius: 12px;
      background: #ffffff;
      box-shadow: 0 2px 6px rgba(0,0,0,.08);
    }
    nav {
      display: flex;
      justify-content: center;
      background: #e6f2ff;
      border-bottom: 1px solid #d1e3f7;
    }
    .tab-btn {
      background: none;
      border: none;
      padding: 16px 32px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--ink);
      transition: background .2s;
    }
    .tab-btn.active {
      background: #fff;
      border-bottom: 2px solid #1f2937;
      font-weight: bold;
    }
    main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }
    .quote-card, .world-card, .calc-card {
      max-width: 720px;
      width: 100%;
      background: var(--card);
      border-radius: 16px;
      padding: 28px 32px;
      box-shadow: 0 6px 24px rgba(0,0,0,.08);
      text-align: center;
      transition: transform .2s ease;
    }
    .quote-card:hover, .world-card:hover, .calc-card:hover { transform: translateY(-2px); }
    .quote-text {
      font-size: clamp(1.2rem, 2.4vw, 1.75rem);
      line-height: 1.5;
    }
    .quote-author {
      margin-top: 12px;
      color: var(--muted);
      font-size: 0.95rem;
    }
    .hint { margin-top: 10px; font-size: .85rem; color: var(--muted); }
    #test-results { margin: 18px auto 0; max-width: 720px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 12px; color: #0f172a; }
    .test-pass { color: #065f46; }
    .test-fail { color: #991b1b; }
    .world-img {
      max-width: 100%;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0,0,0,.10);
      margin-bottom: 12px;
    }
    .world-caption {
      color: var(--muted);
      font-size: 1rem;
      margin-top: 8px;
    }
    .calc-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
      margin-top: 12px;
    }
    .calc-form input, .calc-form select {
      padding: 8px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #d1e3f7;
      width: 120px;
      text-align: center;
    }
    .calc-form button {
      padding: 8px 18px;
      font-size: 1rem;
      border-radius: 6px;
      border: none;
      background: #e6f2ff;
      color: var(--ink);
      cursor: pointer;
      transition: background .2s;
    }
    .calc-form button:hover {
      background: #d1e3f7;
    }
    .calc-result {
      margin-top: 16px;
      font-size: 1.2rem;
      color: #065f46;
      min-height: 1.2em;
    }
  </style>
</head>
<body>
  <header>
    <h1>Hello, Human! üåç</h1>
  </header>

  <nav>
    <button class="tab-btn active" id="tab-quotes" onclick="showTab('quotes')">Quotes</button>
    <button class="tab-btn" id="tab-world" onclick="showTab('world')">World Pic</button>
    <button class="tab-btn" id="tab-calc" onclick="showTab('calc')">Calculator</button>
  </nav>

  <main>
    <article aria-live="polite" aria-busy="true" class="quote-card" id="quote-card">
      <div class="quote-text" id="quote">Loading quote‚Ä¶</div>
      <div class="quote-author" id="author"></div>
      <div class="hint" id="hint">Refresh for a new quote. If the network is blocked, a local random quote is shown.</div>
    </article>
    <article class="world-card" id="world-card" style="display:none;">
      <img class="world-img" src="https://upload.wikimedia.org/wikipedia/commons/9/97/The_Earth_seen_from_Apollo_17.jpg" alt="Earth from space" />
      <div class="world-caption">Earth as seen from Apollo 17 (NASA, 1972)</div>
    </article>
    <article class="calc-card" id="calc-card" style="display:none;">
      <h2>Basic Calculator</h2>
      <form class="calc-form" id="calc-form" onsubmit="event.preventDefault(); calcCompute();">
        <input type="number" id="calc-a" required placeholder="First number" />
        <select id="calc-op">
          <option value="+">+</option>
          <option value="-">‚àí</option>
          <option value="*">√ó</option>
          <option value="/">√∑</option>
        </select>
        <input type="number" id="calc-b" required placeholder="Second number" />
        <button type="submit">Calculate</button>
      </form>
      <div class="calc-result" id="calc-result"></div>
    </article>
  </main>

  <section id="test-results" aria-label="Automated Tests"></section>

  <script>
    // Tab switching logic
    function showTab(tab) {
      document.getElementById('tab-quotes').classList.toggle('active', tab === 'quotes');
      document.getElementById('tab-world').classList.toggle('active', tab === 'world');
      document.getElementById('tab-calc').classList.toggle('active', tab === 'calc');
      document.getElementById('quote-card').style.display = tab === 'quotes' ? '' : 'none';
      document.getElementById('world-card').style.display = tab === 'world' ? '' : 'none';
      document.getElementById('calc-card').style.display = tab === 'calc' ? '' : 'none';
    }

    // Calculator logic
    function calcCompute() {
      const a = parseFloat(document.getElementById('calc-a').value);
      const b = parseFloat(document.getElementById('calc-b').value);
      const op = document.getElementById('calc-op').value;
      let result = '';
      if (isNaN(a) || isNaN(b)) {
        result = 'Please enter valid numbers.';
      } else {
        switch (op) {
          case '+': result = a + b; break;
          case '-': result = a - b; break;
          case '*': result = a * b; break;
          case '/':
            if (b === 0) result = 'Cannot divide by zero.';
            else result = a / b;
            break;
          default: result = 'Unknown operation.';
        }
      }
      document.getElementById('calc-result').textContent = result;
    }

    // API_URL expects a JSON response with { content: string, author: string }
    // Example: { "content": "Quote text", "author": "Author name" }
        const API_URL = 'https://zenquotes.io/api/randoms';
    const LOCAL_QUOTES = [
      { content: "The only limit to our realization of tomorrow is our doubts of today.", author: "Franklin D. Roosevelt" },
      { content: "In the middle of difficulty lies opportunity.", author: "Albert Einstein" },
      { content: "What you do speaks so loudly that I cannot hear what you say.", author: "Ralph Waldo Emerson" },
      { content: "It always seems impossible until it‚Äôs done.", author: "Nelson Mandela" },
      { content: "Simplicity is the ultimate sophistication.", author: "Leonardo da Vinci" },
      { content: "Well begun is half done.", author: "Aristotle" },
      { content: "Do or do not. There is no try.", author: "Yoda" },
      { content: "You miss 100% of the shots you don‚Äôt take.", author: "Wayne Gretzky" },
      { content: "Whether you think you can or you think you can‚Äôt, you‚Äôre right.", author: "Henry Ford" },
      { content: "Stay hungry, stay foolish.", author: "Steve Jobs" },
      { content: "The secret of getting ahead is getting started.", author: "Mark Twain" },
      { content: "Act as if what you do makes a difference. It does.", author: "William James" },
      { content: "Make it work, make it right, make it fast.", author: "Kent Beck" },
      { content: "Perfection is achieved not when there is nothing more to add, but when there is nothing left to take away.", author: "Antoine de Saint‚ÄëExup√©ry" },
      { content: "If you‚Äôre going through hell, keep going.", author: "Winston Churchill" },
      { content: "The best time to plant a tree was 20 years ago. The second best time is now.", author: "Chinese Proverb" },
      { content: "Not all those who wander are lost.", author: "J. R. R. Tolkien" },
      { content: "The journey of a thousand miles begins with one step.", author: "Lao Tzu" },
      { content: "Dream big and dare to fail.", author: "Norman Vaughan" },
      { content: "If I have seen further it is by standing on the shoulders of giants.", author: "Isaac Newton" },
      { content: "Happiness depends upon ourselves.", author: "Aristotle" },
      { content: "Energy and persistence conquer all things.", author: "Benjamin Franklin" },
      { content: "The hard days are what make you stronger.", author: "Aly Raisman" },
      { content: "Start where you are. Use what you have. Do what you can.", author: "Arthur Ashe" },
      { content: "Quality is not an act, it is a habit.", author: "Aristotle" },
      { content: "Jawani me itne kaand karo ki budhapa kahani batane me nikal jaaye", author: "Marathi mulgi" }
    ];

    let UNHANDLED_REJECTIONS = 0;
    window.addEventListener('unhandledrejection', (e) => {
      UNHANDLED_REJECTIONS += 1;
      e.preventDefault?.();
    });

    function pickRandom(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

    async function fetchWithTimeout(url, options = {}, timeoutMs = 2500) {
      const controller = new AbortController();
      const id = setTimeout(() => controller.abort(), timeoutMs);
      try {
        const res = await fetch(url, {
          ...options,
          headers: { 'Accept': 'application/json', ...(options.headers || {}) },
          signal: controller.signal,
        });
        return res;
      } finally {
        clearTimeout(id);
      }
    }

    async function getQuote() {
      try {
        const res = await fetchWithTimeout(API_URL, {}, 2500);
        if (!res || !res.ok) throw new Error('bad status: ' + (res && res.status));
        const data = await res.json();
        if (!data || !data.content) throw new Error('bad payload');
        return { content: data.content, author: data.author || 'Unknown', source: 'api' };
      } catch (err) {
        const local = pickRandom(LOCAL_QUOTES);
        return { ...local, source: 'local', error: (err && err.message) || String(err) };
      }
    }

    function renderQuote(q) {
      const quoteEl = document.getElementById('quote');
      const authorEl = document.getElementById('author');
      const card = document.getElementById('quote-card');
      quoteEl.textContent = `‚Äú${q.content}‚Äù`;
      authorEl.textContent = `‚Äî ${q.author}`;
      card.setAttribute('aria-busy', 'false');
      const hint = document.getElementById('hint');
      hint.textContent = q.source === 'api'
        ? 'Loaded from API. Refresh for a new quote.'
        : 'Loaded from local list (network blocked). Refresh for a new quote.';
    }

    function runTests() {
      const results = [];
      function pass(name) { results.push({ name, ok: true }); }
      function fail(name, msg) { results.push({ name, ok: false, msg }); }

      const text = document.getElementById('quote')?.textContent?.trim() || '';
      if (text && text !== 'Loading quote‚Ä¶' && text.length > 5) pass('renders a quote to the page');
      else fail('renders a quote to the page', 'quote text missing or too short');

      const sample = new Set();
      for (let i = 0; i < 12; i++) sample.add(pickRandom(LOCAL_QUOTES).content);
      if (sample.size > 1) pass('local fallback provides variability across runs');
      else fail('local fallback provides variability across runs', 'random picker not varying');

      const author = document.getElementById('author')?.textContent?.trim() || '';
      if (author.startsWith('‚Äî ') && author.length > 3) pass('shows an author line');
      else fail('shows an author line', 'author line missing');

      if (UNHANDLED_REJECTIONS === 0) pass('no unhandled promise rejections');
      else fail('no unhandled promise rejections', `saw ${UNHANDLED_REJECTIONS}`);

      const busy = document.getElementById('quote-card')?.getAttribute('aria-busy');
      if (busy === 'false') pass('sets aria-busy to false after render');
      else fail('sets aria-busy to false after render', `aria-busy is ${busy}`);

      const hintText = document.getElementById('hint')?.textContent || '';
      if (/Loaded from (API|local list)/.test(hintText)) pass('hint reflects data source');
      else fail('hint reflects data source', 'hint did not mention API or local list');

      const out = document.getElementById('test-results');
      out.innerHTML = results.map(r => r.ok
        ? `<div class="test-pass">‚úî ${r.name}</div>`
        : `<div class="test-fail">‚úò ${r.name} ‚Äî ${r.msg}</div>`
      ).join('');
    }

    (async () => {
      const q = await getQuote();
      renderQuote(q);
      runTests();
    })();
  </script>
</body>
</html>
